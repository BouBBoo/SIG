DROP TABLE Voisin_Salle_Salle;
DROP TABLE Voisin_Salle_Escalier;
DROP TABLE Voisin_Escalier_Escalier;
DROP TABLE SALLE;
DROP TABLE ESCALIER;

CREATE TABLE Salle(
	id integer PRIMARY KEY,
	nom varchar,
	geom geometry,
	type_salle varchar,
	etage integer
);

CREATE TABLE Escalier(
	id integer NOT NULL PRIMARY KEY,
	geom geometry,
	etage_courant integer NOT NULL,
	etage_destination integer NOT NULL
);

CREATE TABLE Voisin_Salle_Salle(
	idSalleCourante integer NOT NULL REFERENCES Salle(id),
	idVoisinDroit integer REFERENCES Salle(id),
	idVoisinGauche integer REFERENCES Salle(id),
	idVoisinFace integer REFERENCES Salle(id)
);

CREATE TABLE Voisin_Salle_Escalier(
	idSalleCourante integer NOT NULL REFERENCES Salle(id),
	idEscalierDroit integer  REFERENCES Escalier(id),
	idEscalierGauche integer  REFERENCES Escalier(id),
	idEscalierFace integer  REFERENCES Escalier(id)
);

CREATE TABLE Voisin_Escalier_Escalier(
	idEscalier1 integer NOT NULL REFERENCES Escalier(id),
	idEscalier2 integer NOT NULL REFERENCES Escalier(id)
);




INSERT INTO SALLE VALUES
	(1, 'E01', 'POLYGON((0 0, 1 0, 1 1, 0 1, 0 0))','Salle de TP',  0),
	(2, 'E02', 'POLYGON((0 0, 1 0, 1 -1, 0 -1, 0 0))','Salle de TP', 0),
	(3, 'Amphi Herbrand', 'POLYGON((0 -1, 1 -1, 1 -2, 0 -2, 0 -1))','Amphi', 0),
	(4, 'E04', 'POLYGON((2 0, 3 0, 3 1, 2 1, 2 0))','Salle de TD', 0),
	(5, 'WC', 'POLYGON((2 0, 3 0, 3 -1, 2 -1, 2 0))','Toilettes', 0),
	(6, 'Infirmerie', 'POLYGON((2 -1, 3 -1, 3 -2, 2 -2, 2 -1))','Infirmerie', 0),
	(7, 'Bureau directeur', 'POLYGON((2 0, 3 0, 3 1, 2 1, 2 0))','Administration', 1),
	(8, 'Secretariat', 'POLYGON((2 0, 3 0, 3 -1, 2 -1, 2 0))','Administration', 1),
	(9, 'Salle de r√©union', 'POLYGON((0 0, 1 0, 1 -1, 0 -1, 0 0))','Administration', 1),
	(10, 'E11', 'POLYGON((0 0, 1 0, 1 1, 0 1, 0 0))','Salle de TD', 1);

INSERT INTO Escalier VALUES
	(1, 'POLYGON((0 1, 1 1, 1 1.5, 0 1.5, 0 1))', 0, 1),
	(2, 'POLYGON((0 1, 1 1, 1 1.5, 0 1.5, 0 1))', 1, 0);


INSERT INTO Voisin_Salle_Salle VALUES
	(1, 2, NULL, 4),
	(2, 3, 1, 5),
	(3, NULL, 2, 6),
	(4, null, 5, 1),
	(5, 4, 6, 2),
	(6, 5, null, 3),
	(7, null, 8, 10),
	(8, 7, null, 9),
	(9, null, 10, 9),
	(10, 9, null, 7);

INSERT INTO Voisin_Salle_Escalier VALUES
	(1, 1, null, null),
	(10, 2, null, null);

INSERT into Voisin_Escalier_Escalier VALUES
	(1, 2);